import{defineComponent as e,getCurrentInstance as t,setTransitionHooks as r}from"vue";const n=e=>null==e,o=e=>n(e)||""===e,a={keyName:"page_key",componentName:"StackRouterView"};let s;const u=e=>{s=Object.assign(Object.assign({},a),((e,...t)=>{const r={};if(!e||!t)return r;for(const o of t)n(e[o])||(r[o]=e[o]);return r})(e,"keyName","componentName"))},c=()=>s;var i;!function(e){e.PUSH="push",e.GO="go",e.REPLACE="replace",e.BACK="back",e.FORWARD="forward"}(i||(i={}));const l={value:i.PUSH},p=e=>{l.value=e},v=()=>l;let h;const d=()=>h;class m{constructor(e){var t;this.value=null!==(t=null==e?void 0:e.value)&&void 0!==t?t:[]}push(e){return this.value.push(e)}pop(){return this.value.pop()}removeAfter(e){const t=this.value.findIndex((t=>t.key===e));if(-1===t)return;const r=t+1;return r>=this.value.length?void 0:this.value.splice(r,this.value.length-t-1)}clear(){const e=this.value;return this.value=[],e}get(e){var t;return null===(t=this.value.find((t=>t.key===e)))||void 0===t?void 0:t.vnode}}const f=(()=>{const e=new m;return()=>e})();function g(e){let t=e.shapeFlag;256&t&&(t-=256),512&t&&(t-=512),e.shapeFlag=t}const y=e({inheritRef:!0,__isKeepAlive:!0,props:{component:{type:Object,default:void 0},route:{type:Object,required:!0}},setup(e){const n=f(),o=v(),{keyName:a}=c(),s=t(),u=s.ctx,l=s.suspense,{renderer:{m:p,um:h,o:{createElement:d}}}=u,m=d("div");function y(e){if(e)for(;e.length;){const t=e.pop();t&&(g(t.vnode),h(t.vnode,s,l))}}return u.activate=(e,t,r,n,o)=>{p(e,t,r,0,l)},u.deactivate=e=>{p(e,m,null,1,l)},()=>{const{component:t,route:s}=e,u=s.query[a],c=n.get(u),l=t;return l?c?(y(n.removeAfter(u)),c.transition&&r(c,c.transition),c.shapeFlag|=512,c):(o.value===i.REPLACE&&y(n.clear()),n.push({key:u,vnode:l}),l.shapeFlag|=256,l):l}}}),b=()=>{const{keyName:e}=c(),{router:t}=d(),r=v();t.beforeEach(((t,n)=>{if(o(t.query[e])){t.query[e]=((e=6)=>Math.random().toString(16).substring(2,e+2))();const a=r.value===i.REPLACE||o(n.query[e]);return{hash:t.hash,path:t.path,name:t.name,params:t.params,query:t.query,meta:t.meta,replace:a}}return!0}))},k={install(e,t){const{router:r}=t;if(!r)throw Error("\n vue-router is necessary. \n\n");u(t),h={app:e,router:r},(()=>{const{app:e,router:t}=d(),r=t.push.bind(t),n=t.go.bind(t),o=t.replace.bind(t),a=t.back.bind(t),s=t.forward.bind(t);e.config.globalProperties.$router||e.use(t),t.push=e=>(p(i.PUSH),r(e)),t.go=e=>{p(i.GO),n(e)},t.replace=e=>(p(i.REPLACE),o(e)),t.back=()=>{p(i.BACK),a()},t.forward=()=>{p(i.FORWARD),s()}})(),(()=>{const{componentName:e}=c(),{app:t}=d();t.component(e,y)})(),b()}};export default k;export{v as useAction,f as useStack};
//# sourceMappingURL=vue-router-plugin.esm.js.map
