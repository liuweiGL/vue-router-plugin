import{defineComponent as e,getCurrentInstance as t,setTransitionHooks as r}from"vue";const n=e=>null==e,o=e=>n(e)||""===e,s={keyName:"page_key",componentName:"StackRouterView"};let a;const i=e=>{a=Object.assign(Object.assign({},s),((e,...t)=>{const r={};if(!e||!t)return r;for(const o of t)n(e[o])||(r[o]=e[o]);return r})(e,"keyName","componentName"))},u=()=>a;var c;!function(e){e.PUSH="push",e.GO="go",e.REPLACE="replace",e.BACK="back",e.FORWARD="forward"}(c||(c={}));const p={value:c.PUSH},l=e=>{p.value=e},m=()=>p;let h;const d=()=>h;class v{constructor(e){var t;this.items=null!==(t=null==e?void 0:e.value)&&void 0!==t?t:[]}push(e){return this.items.push(e)}pop(){return this.items.pop()}removeAfter(e){const t=this.items.findIndex((t=>t.key===e));if(-1===t)return;const r=t+1;return r>=this.items.length?void 0:this.items.splice(r,this.items.length-t-1)}clear(){const e=this.items;return this.items=[],e}find(e){var t;return null===(t=this.items.find((t=>t.key===e)))||void 0===t?void 0:t.vnode}value(){return this.items}}const f=(()=>{const e=new v;return()=>e})();function g(e){let t=e.shapeFlag;256&t&&(t-=256),512&t&&(t-=512),e.shapeFlag=t}const y=e({inheritRef:!0,__isKeepAlive:!0,props:{component:{type:Object,default:void 0},route:{type:Object,required:!0}},setup(e){const n=f(),o=m(),{keyName:s}=u(),a=t(),i=a.ctx,p=a.suspense,{renderer:{m:l,um:h,o:{createElement:d}}}=i,v=d("div");function y(e){if(e)for(;e.length;){const t=e.pop();t&&(g(t.vnode),h(t.vnode,a,p))}}return i.activate=(e,t,r,n,o)=>{l(e,t,r,0,p)},i.deactivate=e=>{l(e,v,null,1,p)},()=>{const{component:t,route:a}=e,i=a.query[s],u=n.find(i),p=t;return p?u?(y(n.removeAfter(i)),u.transition&&r(u,u.transition),u.shapeFlag|=512,u):(o.value===c.REPLACE&&y(n.clear()),n.push({key:i,vnode:p}),p.shapeFlag|=256,p):p}}}),b=()=>{const{keyName:e}=u(),{router:t}=d(),r=m();t.beforeEach(((t,n)=>{if(o(t.query[e])){t.query[e]=((e=6)=>Math.random().toString(16).substring(2,e+2))();const s=r.value===c.REPLACE||o(n.query[e]);return{hash:t.hash,path:t.path,name:t.name,params:t.params,query:t.query,meta:t.meta,replace:s}}return!0}))},k={install(e,t){const{router:r}=t;if(!r)throw Error("\n vue-router is necessary. \n\n");i(t),h={app:e,router:r},(()=>{const{app:e,router:t}=d(),r=t.push.bind(t),n=t.go.bind(t),o=t.replace.bind(t),s=t.back.bind(t),a=t.forward.bind(t);e.config.globalProperties.$router||e.use(t),t.push=e=>(l(c.PUSH),r(e)),t.go=e=>{l(c.GO),n(e)},t.replace=e=>(l(c.REPLACE),o(e)),t.back=()=>{l(c.BACK),s()},t.forward=()=>{l(c.FORWARD),a()}})(),(()=>{const{componentName:e}=u(),{app:t}=d();t.component(e,y)})(),b()}};export default k;export{m as useAction,f as useStack};
//# sourceMappingURL=vue-router-plugin.esm.js.map
