import{defineComponent as e,getCurrentInstance as t,setTransitionHooks as r}from"vue";const n=e=>null==e,o=e=>n(e)||""===e,a=(e,...t)=>{const r={};if(!e||!t)return r;for(const o of t)n(e[o])||(r[o]=e[o]);return r},u={keyName:"page_key",componentName:"StackRouterView"};let s;const c=()=>s;var p;!function(e){e.PUSH="push",e.GO="go",e.REPLACE="replace",e.BACK="back",e.FORWARD="forward"}(p||(p={}));const i={value:p.PUSH},l=e=>{i.value=e},h=()=>i;let v;const m=()=>v;class d{constructor(e){this.value=e?.value??[]}push(e){return this.value.push(e)}pop(){return this.value.pop()}removeAfter(e){const t=this.value.findIndex((t=>t.key===e));if(-1===t)return;const r=t+1;return r>=this.value.length?void 0:this.value.splice(r,this.value.length-t-1)}clear(){const e=this.value;return this.value=[],e}get(e){return this.value.find((t=>t.key===e))?.vnode}}const f=(()=>{const e=new d;return()=>e})();function g(e){let t=e.shapeFlag;256&t&&(t-=256),512&t&&(t-=512),e.shapeFlag=t}const y=e({inheritRef:!0,__isKeepAlive:!0,props:{component:{type:Object,default:void 0},route:{type:Object,required:!0}},setup(e){const n=f(),o=h(),{keyName:a}=c(),u=t(),s=u.ctx,i=u.suspense,{renderer:{m:l,um:v,o:{createElement:m}}}=s,d=m("div");function y(e){if(e)for(;e.length;){const t=e.pop();t&&(g(t.vnode),v(t.vnode,u,i))}}return s.activate=(e,t,r,n,o)=>{l(e,t,r,0,i)},s.deactivate=e=>{l(e,d,null,1,i)},()=>{const{component:t,route:u}=e,s=u.query[a],c=n.get(s),i=t;return i?c?(y(n.removeAfter(s)),c.transition&&r(c,c.transition),c.shapeFlag|=512,c):(o.value===p.REPLACE&&y(n.clear()),n.push({key:s,vnode:i}),i.shapeFlag|=256,i):i}}}),b=()=>{const{keyName:e}=c(),{router:t}=m(),r=h();t.beforeEach(((t,n)=>{if(o(t.query[e])){t.query[e]=((e=6)=>Math.random().toString(16).substring(2,e+2))();const a=r.value===p.REPLACE||o(n.query[e]);return{hash:t.hash,path:t.path,name:t.name,params:t.params,query:t.query,meta:t.meta,replace:a}}return!0}))},k={install(e,t){const{router:r}=t;if(!r)throw Error("\n vue-router is necessary. \n\n");(e=>{s={...u,...a(e,"keyName","componentName")}})(t),v={app:e,router:r},(()=>{const{app:e,router:t}=m(),r=t.push.bind(t),n=t.go.bind(t),o=t.replace.bind(t),a=t.back.bind(t),u=t.forward.bind(t);e.config.globalProperties.$router||e.use(t),t.push=e=>(l(p.PUSH),r(e)),t.go=e=>{l(p.GO),n(e)},t.replace=e=>(l(p.REPLACE),o(e)),t.back=()=>{l(p.BACK),a()},t.forward=()=>{l(p.FORWARD),u()}})(),(()=>{const{componentName:e}=c(),{app:t}=m();t.component(e,y)})(),b()}};export default k;export{h as useAction,f as useStack};
//# sourceMappingURL=vue-router-plugin.esm.js.map
