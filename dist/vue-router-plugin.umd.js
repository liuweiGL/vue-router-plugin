!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueRouterPlugin={},e.Vue)}(this,(function(e,t){"use strict";const n=e=>null==e,o=e=>n(e)||""===e,r={keyName:"page_key",componentName:"StackRouterView"};let s;const i=e=>{s=Object.assign(Object.assign({},r),((e,...t)=>{const o={};if(!e||!t)return o;for(const r of t)n(e[r])||(o[r]=e[r]);return o})(e,"keyName","componentName"))},a=()=>s;var u;!function(e){e.PUSH="push",e.GO="go",e.REPLACE="replace",e.BACK="back",e.FORWARD="forward"}(u||(u={}));const c={value:u.PUSH},p=e=>{c.value=e},l=()=>c;let d;const f=()=>d;class h{constructor(e){var t;this.items=null!==(t=null==e?void 0:e.items)&&void 0!==t?t:[]}push(e){return this.items.push(e)}pop(){return this.items.pop()}removeAfter(e){const t=this.items.findIndex((t=>t.key===e));if(-1===t)return;const n=t+1;return n>=this.items.length?void 0:this.items.splice(n,this.items.length-t-1)}clear(){const e=this.items;return this.items=[],e}find(e){var t;return null===(t=this.items.find((t=>t.key===e)))||void 0===t?void 0:t.vnode}value(){return this.items}}const m=(()=>{const e=new h;return()=>e})();function v(e){let t=e.shapeFlag;256&t&&(t-=256),512&t&&(t-=512),e.shapeFlag=t}function y(e,n){n&&n.pendingBranch?Array.isArray(e)?n.effects.push(...e):n.effects.push(e):t.queuePostFlushCb(e)}function g(e,n,o,r=null){t.callWithAsyncErrorHandling(e,n,7,[o,r])}function b(e,t){for(let n=0;n<e.length;n++)e[n](t)}const A=t.defineComponent({inheritRef:!0,__isKeepAlive:!0,props:{component:{type:Object,default:void 0},route:{type:Object,required:!0}},setup(e){const n=m(),o=l(),{keyName:r}=a(),s=t.getCurrentInstance(),i=s.ctx,c=s.suspense,{renderer:{p:p,m:d,um:f,o:{createElement:h}}}=i,A=h("div");function k(e){if(e)for(;e.length;){const t=e.pop();t&&(v(t.vnode),f(t.vnode,s,c))}}return i.activate=(e,t,n,o,r)=>{const s=e.component;d(e,t,n,0,c),p(s.vnode,e,t,n,s,c,o,e.slotScopeIds,r),y((()=>{s.isDeactivated=!1,s.a&&b(s.a);const t=e.props&&e.props.onVnodeMounted;t&&g(t,s.parent,e)}),c)},i.deactivate=e=>{const t=e.component;d(e,A,null,1,c),y((()=>{t.da&&b(t.da);const n=e.props&&e.props.onVnodeUnmounted;n&&g(n,t.parent,e),t.isDeactivated=!0}),c)},()=>{const{component:s,route:i}=e,a=i.query[r],c=n.find(a),p=s;return p?c?(k(n.removeAfter(a)),c.transition&&t.setTransitionHooks(c,c.transition),c.shapeFlag|=512,c):(o.value===u.REPLACE&&k(n.clear()),n.push({key:a,vnode:p}),p.shapeFlag|=256,p):p}}}),k=()=>{const{keyName:e}=a(),{router:t}=f(),n=l();t.beforeEach(((t,r)=>{if(o(t.query[e])){t.query[e]=((e=6)=>Math.random().toString(16).substring(2,e+2))();const s=n.value===u.REPLACE||o(r.query[e]);return{hash:t.hash,path:t.path,name:t.name,params:t.params,query:t.query,meta:t.meta,replace:s}}return!0}))},E={install(e,t){const{router:n}=t;if(!n)throw Error("\n vue-router is necessary. \n\n");i(t),d={app:e,router:n},(()=>{const{app:e,router:t}=f(),n=t.push.bind(t),o=t.go.bind(t),r=t.replace.bind(t),s=t.back.bind(t),i=t.forward.bind(t);e.config.globalProperties.$router||e.use(t),t.push=e=>(p(u.PUSH),n(e)),t.go=e=>{p(u.GO),o(e)},t.replace=e=>(p(u.REPLACE),r(e)),t.back=()=>{p(u.BACK),s()},t.forward=()=>{p(u.FORWARD),i()}})(),(()=>{const{componentName:e}=a(),{app:t}=f();t.component(e,A)})(),k()}};e.default=E,e.useAction=l,e.useStack=m,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=vue-router-plugin.umd.js.map
