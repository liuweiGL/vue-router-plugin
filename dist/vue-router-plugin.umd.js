!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).VueRouterPlugin={},e.Vue)}(this,(function(e,t){"use strict";const n=e=>null==e,r=e=>n(e)||""===e,o=(e,...t)=>{const r={};if(!e||!t)return r;for(const o of t)n(e[o])||(r[o]=e[o]);return r},a={keyName:"page_key",componentName:"StackRouterView"};let u;const s=()=>u;var i;!function(e){e.PUSH="push",e.GO="go",e.REPLACE="replace",e.BACK="back",e.FORWARD="forward"}(i||(i={}));const c={value:i.PUSH},p=e=>{c.value=e},l=()=>c;let f;const d=()=>f;class h{constructor(e){this.value=e?.value??[]}push(e){return this.value.push(e)}pop(){return this.value.pop()}removeAfter(e){const t=this.value.findIndex((t=>t.key===e));if(-1===t)return;const n=t+1;return n>=this.value.length?void 0:this.value.splice(n,this.value.length-t-1)}clear(){const e=this.value;return this.value=[],e}get(e){return this.value.find((t=>t.key===e))?.vnode}}const v=(()=>{const e=new h;return()=>e})();function m(e){let t=e.shapeFlag;256&t&&(t-=256),512&t&&(t-=512),e.shapeFlag=t}const y=t.defineComponent({inheritRef:!0,__isKeepAlive:!0,props:{component:{type:Object,default:void 0},route:{type:Object,required:!0}},setup(e){const n=v(),r=l(),{keyName:o}=s(),a=t.getCurrentInstance(),u=a.ctx,c=a.suspense,{renderer:{m:p,um:f,o:{createElement:d}}}=u,h=d("div");function y(e){if(e)for(;e.length;){const t=e.pop();t&&(m(t.vnode),f(t.vnode,a,c))}}return u.activate=(e,t,n,r,o)=>{p(e,t,n,0,c)},u.deactivate=e=>{p(e,h,null,1,c)},()=>{const{component:a,route:u}=e,s=u.query[o],c=n.get(s),p=a;return p?c?(y(n.removeAfter(s)),c.transition&&t.setTransitionHooks(c,c.transition),c.shapeFlag|=512,c):(r.value===i.REPLACE&&y(n.clear()),n.push({key:s,vnode:p}),p.shapeFlag|=256,p):p}}}),g=()=>{const{keyName:e}=s(),{router:t}=d(),n=l();t.beforeEach(((t,o)=>{if(r(t.query[e])){t.query[e]=((e=6)=>Math.random().toString(16).substring(2,e+2))();const a=n.value===i.REPLACE||r(o.query[e]);return{hash:t.hash,path:t.path,name:t.name,params:t.params,query:t.query,meta:t.meta,replace:a}}return!0}))},b={install(e,t){const{router:n}=t;if(!n)throw Error("\n vue-router is necessary. \n\n");(e=>{u={...a,...o(e,"keyName","componentName")}})(t),f={app:e,router:n},(()=>{const{app:e,router:t}=d(),n=t.push.bind(t),r=t.go.bind(t),o=t.replace.bind(t),a=t.back.bind(t),u=t.forward.bind(t);e.config.globalProperties.$router||e.use(t),t.push=e=>(p(i.PUSH),n(e)),t.go=e=>{p(i.GO),r(e)},t.replace=e=>(p(i.REPLACE),o(e)),t.back=()=>{p(i.BACK),a()},t.forward=()=>{p(i.FORWARD),u()}})(),(()=>{const{componentName:e}=s(),{app:t}=d();t.component(e,y)})(),g()}};e.default=b,e.useAction=l,e.useStack=v,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=vue-router-plugin.umd.js.map
